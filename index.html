<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Neon Dash Ultra</title>
<style>
html,body{margin:0;overflow:hidden;background:#05070d;font-family:Arial}
canvas{display:block}
.panel{
position:absolute;top:50%;left:50%;
transform:translate(-50%,-50%);
text-align:center;color:white
}
.btn{
padding:14px 32px;margin:10px;
background:linear-gradient(45deg,#ff2fb3,#7f00ff);
border-radius:14px;cursor:pointer;
box-shadow:0 0 25px #ff2fb3;
font-weight:bold
}
.level{
padding:16px;margin:12px;
border-radius:14px;
background:#11152c;
box-shadow:0 0 18px #7f00ff
}
.locked{opacity:0.3}
</style>
</head>
<body>

<canvas id="c"></canvas>

<div id="menu" class="panel">
  <h1 style="font-size:48px;color:#ff2fb3">NEON DASH ULTRA</h1>
  <div class="btn" onclick="openLevels()">PLAY</div>
  <div class="btn" onclick="openShop()">SHOP</div>
</div>

<div id="levels" class="panel" style="display:none"></div>
<div id="shop" class="panel" style="display:none"></div>

<script>
const c=document.getElementById("c"),ctx=c.getContext("2d");
function resize(){c.width=innerWidth;c.height=innerHeight}
resize();onresize=resize;

let state="menu",currentLevel=0,practice=false;
let x=200,y,vy=0,gravity=0.9,scroll=0,speed=7;
let ground,attempts=0,shake=0;
let mode="cube",coins=+localStorage.coins||0;
let cubeColor=localStorage.color||"#ff2fb3";
let checkpoints=[];

const levelsData=[
{name:"Stereo Madness X",unlocked:true,
objects:[
{x:600,t:"spike"},{x:900,t:"pad"},
{x:1200,t:"portal",m:"ship"},
{x:1600,t:"spike"},
{x:1900,t:"portal",m:"cube"},
{x:2400,t:"finish"}
]},
{name:"Electro Vibes",unlocked:false,
objects:[
{x:500,t:"spike"},{x:800,t:"spike"},
{x:1000,t:"portal",m:"wave"},
{x:1400,t:"orb"},
{x:1800,t:"portal",m:"cube"},
{x:2300,t:"finish"}
]}
];

function openLevels(){
menu.style.display="none";
levels.innerHTML="<h2>SELECT LEVEL</h2>";
levelsData.forEach((l,i)=>{
levels.innerHTML+=`
<div class="level ${l.unlocked?"":"locked"}">
<b>${l.name}</b><br>
${l.unlocked?`
<div class="btn" onclick="startLevel(${i},false)">NORMAL</div>
<div class="btn" onclick="startLevel(${i},true)">PRACTICE</div>`:"LOCKED"}
</div>`;
});
levels.innerHTML+=`<div class="btn" onclick="backMenu()">BACK</div>`;
levels.style.display="block";
}

function startLevel(i,p){
if(!levelsData[i].unlocked)return;
practice=p;currentLevel=i;
levels.style.display="none";
attempts++;scroll=0;vy=0;
mode="cube";state="play";
ground=c.height-120;y=ground;
checkpoints=[];
}

function backMenu(){
levels.style.display="none";
shop.style.display="none";
menu.style.display="block";
}

function openShop(){
menu.style.display="none";
shop.innerHTML=`<h2>SHOP<br>Coins: ${coins}</h2>`;
["#ff2fb3","#00ffff","#00ff88","#ffaa00"].forEach(c=>{
shop.innerHTML+=`<div class="btn" style="background:${c}" onclick="buy('${c}')">BUY</div>`;
});
shop.innerHTML+=`<div class="btn" onclick="backMenu()">BACK</div>`;
shop.style.display="block";
}

function buy(c){cubeColor=c;localStorage.color=c}

addEventListener("keydown",jump);
addEventListener("mousedown",jump);
function jump(){
if(state!=="play")return;
if(mode==="cube"&&y>=ground)vy=-15;
if(mode==="ship")vy-=1.4;
if(mode==="wave")vy=-vy||-12;
}

function die(){
shake=20;
if(practice&&checkpoints.length){
let cp=checkpoints.at(-1);
scroll=cp.scroll;y=cp.y;vy=0;
}else{
state="menu";menu.style.display="block";
}
}

function update(){
ctx.setTransform(1,0,0,1,0,0);
ctx.clearRect(0,0,c.width,c.height);
ctx.translate(Math.random()*shake,Math.random()*shake);
shake*=0.9;

ctx.fillStyle="#070b1f";
ctx.fillRect(0,0,c.width,c.height);

if(state==="play"){
scroll+=speed;
vy+=gravity;y+=vy;
if(y>ground){y=ground;vy=0}

ctx.fillStyle=cubeColor;
ctx.fillRect(x,y-40,40,40);

levelsData[currentLevel].objects.forEach(o=>{
let ox=o.x-scroll;
if(o.t==="spike"){
ctx.fillStyle="#ff2fb3";
ctx.beginPath();
ctx.moveTo(ox,y);
ctx.lineTo(ox+30,y);
ctx.lineTo(ox+15,y-40);
ctx.fill();
if(ox<x+40&&ox+30>x&&y>=ground-40)die();
}
if(o.t==="pad"){
ctx.fillStyle="#ff0";
ctx.fillRect(ox,y-10,40,10);
if(ox<x+40&&ox+40>x&&y>=ground-1){
vy=-22;coins++;localStorage.coins=coins;
if(practice)checkpoints.push({scroll,y});
}
}
if(o.t==="orb"){
ctx.fillStyle="#0ff";
ctx.beginPath();ctx.arc(ox+15,y-25,15,0,Math.PI*2);ctx.fill();
if(ox<x+40&&ox+30>x)vy=-18;
}
if(o.t==="portal"){
ctx.strokeStyle="#0ff";
ctx.strokeRect(ox,y-60,40,60);
if(ox<x+40&&ox+40>x)mode=o.m;
}
if(o.t==="finish"&&ox<x+40){
levelsData[currentLevel+1]&&(levelsData[currentLevel+1].unlocked=true);
state="menu";menu.style.display="block";
}
});

ctx.fillStyle="white";
ctx.fillText("Mode: "+mode,20,30);
ctx.fillText("Attempts: "+attempts,20,50);
}
requestAnimationFrame(update);
}
update();
</script>
</body>
</html>
